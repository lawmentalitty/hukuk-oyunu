<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta property="og:title" content="Paralel Evrende Hangi Hukuk Karakterisin?">
  <meta property="og:description" content="Hukuk karakterlerinden hangisi olduÄŸunu keÅŸfetmek iÃ§in bu eÄŸlenceli testi Ã§Ã¶z ve sonucunu paylaÅŸ!">
  <meta property="og:image" content="https://via.placeholder.com/1200x630/000000/00FF00?text=Paralel+Evren+Hukuk+Oyunu">
  <meta property="og:url" content=""> 
  <meta property="og:type" content="website">
  <meta name="twitter:card" content="summary_large_image">

  <title>Paralel Evrende Hangi Hukuk Karakterisin?</title>
  <style>
     * {
       box-sizing: border-box;
     }
     body {
       background-color: black;
       color: #00ff00;
       font-family: monospace;
       display: flex;
       flex-direction: column;
       align-items: center;
       justify-content: center;
       padding: 20px;
       min-height: 100vh;
       margin: 0;
       text-align: center;
     }
     h1 { 
       font-size: clamp(26px, 6vw, 40px); 
       font-weight: normal;
       color: #00dd00; 
       text-transform: uppercase;
       letter-spacing: 0.08em;
       width: 90%;
       margin-top: 20px; 
       margin-bottom: 25px; 
       line-height: 1.3;
     }
     .separator { 
         width: 70%;
         max-width: 350px;
         border: none;
         height: 1px;
         background: linear-gradient(to right, transparent, rgba(0,255,0,0.35), transparent);
         margin: 20px 0;
     }
     #result {
       font-size: clamp(32px, 8vw, 50px); 
       min-height: 50px; 
       margin-top: 15px; 
       margin-bottom: 15px; 
       font-weight: bold;
       color: #39FF14;
       opacity: 0; 
       padding: 10px; 
       transition: box-shadow 0.3s ease-out; 
     }
     #result.flickering { 
       opacity: 1; 
       animation: flickerAnimation 0.2s infinite;
       box-shadow: none; 
     }
     #result.revealed { 
         animation: revealResultAnimation 0.6s ease-out forwards;
         box-shadow: 0 0 20px rgba(57, 255, 20, 0.25), 
                       0 0 8px rgba(57, 255, 20, 0.2) inset;
     }
     @keyframes flickerAnimation {
       0%, 100% { opacity: 1; }
       50% { opacity: 0.4; }
     }
     @keyframes revealResultAnimation { 
       0% {
         opacity: 0;
         transform: translateY(20px) scale(0.95);
       }
       100% {
         opacity: 1;
         transform: translateY(0) scale(1);
       }
     }
     button {
       background-color: #000;
       color: #0f0;
       border: 2px solid #0f0;
       padding: 12px 24px;
       font-size: clamp(16px, 5vw, 20px); 
       cursor: pointer;
       margin: 8px; 
       border-radius: 6px; 
       width: 90%;
       max-width: 300px;
       transition: background-color 0.2s, color 0.2s, transform 0.1s, box-shadow 0.2s;
     }
     button:hover:not(:disabled) { 
       background-color: #0f0;
       color: #000;
       box-shadow: 0 0 10px rgba(0, 255, 0, 0.6); 
     }
     button:active:not(:disabled) {
         transform: scale(0.97); 
     }
     button:disabled {
         border-color: #077007;
         color: #077007;
         cursor: not-allowed;
         opacity: 0.6; 
     }
     #shareBtn { 
       opacity: 0;
       visibility: hidden;
       transition: opacity 0.4s ease-in-out, visibility 0.4s ease-in-out;
     }
     #shareBtn.visible { 
         opacity: 1;
         visibility: visible;
     }
     .footer-info {
         margin-top: 40px; 
         display: flex;
         flex-direction: column;
         align-items: center;
         gap: 10px; 
     }
     .creator-credit {
         font-size: clamp(12px, 3.2vw, 14px); 
         color: rgba(0, 255, 0, 0.75);
         line-height: 1.5; 
     }
     .creator-credit .creator-name {
         color: #00ff00; 
         text-decoration: none; 
         font-weight: bold;
     }
     .creator-credit .creator-name:hover {
         color: #39FF14;
         text-decoration: underline;
     }

     /* SayaÃ§ iÃ§in stil */
     #playCounter {
        margin-top: 15px; 
        margin-bottom: 10px;
        font-size: clamp(14px, 3.5vw, 16px); 
        color: #00cc00; 
        min-height: 20px; 
        display: none; 
     }

     @media (min-width: 768px) {
       h1 { font-size: 40px; letter-spacing: 0.1em;}
       #result { font-size: 50px; } 
       button { font-size: 20px; padding: 12px 32px; } 
       .creator-credit { font-size: 14px; }
       #playCounter { font-size: 16px; }
     }
  </style>
</head>
<body>
  <h1>Paralel Evrende<br>Hangi Hukuk Karakterisin?</h1>
  <hr class="separator"> 
  <div id="result">?</div>
  <hr class="separator"> 
  
  <button id="playButton" onclick="playGame()">OYNA</button>
  <div id="playCounter">YÃ¼kleniyor...</div> 
  <button id="shareBtn" onclick="shareResult()">Sonucu X'te PaylaÅŸ</button> 

  <div class="footer-info">
     <p class="creator-credit">Bu bir <a href="https://twitter.com/lawmentalitty" target="_blank" class="creator-name">Yusuf</a> yapÄ±mÄ±dÄ±r. <br>GÃ¶rÃ¼ÅŸlerinizi X Ã¼zerinden iletebilirsiniz.</p>
  </div>

  <script>
    // --- OG:URL Ayarlama ---
    document.addEventListener('DOMContentLoaded', function() {
        try {
            const ogUrlMeta = document.querySelector('meta[property="og:url"]');
            if (ogUrlMeta) {
                ogUrlMeta.setAttribute('content', window.location.href);
            }
        } catch (e) {
            console.error("OG:URL ayarlama hatasÄ±:", e);
        }
        fetchAndShowPlayCount(true); 
    });

    // --- Oyun Karakterleri ---
    const characters = [ 
       "ÅžeytanÄ±n AvukatÄ±", "Gaip", "TutukluluÄŸa Ä°tirazÄ± Kabul Olan MÃ¼dafi", "Kanun Koyucu", "Themis",
       "Asli Kurucu Ä°ktidar", "Evlenen", "GÃ¼veni KÃ¶tÃ¼ye KullanÄ±lan", "Avukato", "Kader Mahkumu",
       "Her Åžeye Ä°tiraz Eden", "Eser", "BilirkiÅŸi", "SÃ¼re Stresi YaÅŸayan", "Nafaka Alan",
       "Nafaka Ã–deyen", "Persona Non Grata", "Kumar OynanmasÄ± Ä°Ã§in Yer ve Ä°mkan SaÄŸlayan",
       "Tutuklu (SevdiÄŸine KarÅŸÄ±)", "AÅŸÄ±rÄ± Ä°yi Niyetli ÃœÃ§Ã¼ncÃ¼ KiÅŸi", "Akraba Ä°ÅŸi Almak Zorunda Kalan",
       "Adliye MuhtarÄ±", "HaksÄ±z Rekabet OluÅŸturan", "SÃ¼rekli YargÄ±tay KararÄ± PaylaÅŸan", "AldatÄ±lan",
       "Her Åžeye Tutanak Tutan", "Elif EylÃ¼l", "Darbe Yapan (Kalplere)", "DosyayÄ± KiÅŸiselleÅŸtiren",
       "AÅŸÄ±rÄ± YararlanÄ±lan (Kendisinden)", "Terk Edilen", "AÄŸÄ±r Ceza Mahkemesi BaÅŸkanÄ±",
       "Memurlarla KavgalÄ± Olan", "AlacaklÄ± (Hayattan)", "Adli Tatil SevdalÄ±sÄ±", "Sebedsiz ZenginleÅŸen",
       "DilekÃ§esinde Åžiir Kullanan", "Basiretli Tacir", "Harvey Specter", "Siyasi Parti Kuran",
       "Ã‡ekiÅŸmeli BoÅŸanma Seven", "Affeden Taraf", "Alkol veya UyuÅŸturucu Madde Etkisinde Olan Taraf",
       "YargÄ±tay Cumhuriyet BaÅŸsavcÄ±sÄ±", "Tam Ehliyetsiz (sevince)", "Donatan", "Ã–zel Hukuk GÃ¼zel KiÅŸisi",
       "Saul Goodman", "NiÅŸanlanan", "DilekÃ§elerini Son GÃ¼ne BÄ±rakan", "Adli Tatilde Daha YoÄŸun Ã‡alÄ±ÅŸan",
       "CumhurbaÅŸkanÄ±", "Bedel Ã–deyen", "Alkol BaÄŸÄ±mlÄ±lÄ±ÄŸÄ± Sebebiyle KÄ±sÄ±tlanan"
    ];

    // --- HTML Elementleri ---
    const resultEl = document.getElementById('result');
    const playButtonEl = document.getElementById('playButton');
    const shareBtn = document.getElementById('shareBtn');
    const playCounterEl = document.getElementById('playCounter'); 

    // --- Animasyon Sesi ---
    let gameAnimationSound;
    const gameAnimationDuration = 2200; // milisaniye, setTimeout ile eÅŸleÅŸmeli

    try {
        // LÃœTFEN 'audio/animasyon_sesi.mp3' KISMINI KENDÄ° DOSYA ADINIZLA DEÄžÄ°ÅžTÄ°RÄ°N!
        gameAnimationSound = new Audio('audio/animasyon_sesi.mp3'); 
        gameAnimationSound.preload = "auto";
    } catch (e) {
        console.warn("Oyun animasyon sesi yÃ¼klenirken hata:", e);
        // Hata durumunda ses Ã§almayacak sahte bir obje oluÅŸtur
        gameAnimationSound = { play: () => Promise.resolve(), pause: () => {}, currentTime: 0 }; 
    }

    // --- Oyun DeÄŸiÅŸkenleri ---
    let intervalId;
    let displayOrderCharacters = []; 
    let currentDisplayIndex = 0; 

    // --- SayaÃ§ FonksiyonlarÄ± ---
    function positionCounter(afterPlayButton) {
        if (playCounterEl && playButtonEl && shareBtn) {
            if (afterPlayButton) {
                playButtonEl.after(playCounterEl);
            } else {
                shareBtn.after(playCounterEl);
            }
            playCounterEl.style.display = 'block'; 
        }
    }

    async function fetchAndShowPlayCount(isInitialLoad = false) {
      try {
        const response = await fetch('/api/getPlayCount');
        if (!response.ok) {
          throw new Error(`Okunma sayÄ±sÄ± alÄ±namadÄ±: ${response.statusText}`);
        }
        const data = await response.json();
        if (playCounterEl) {
          playCounterEl.textContent = `Bu oyun ${data.count} kez oynandÄ±.`;
          if (isInitialLoad) {
            positionCounter(true); 
          }
        }
      } catch (error) {
        console.error('SayaÃ§ getirme hatasÄ±:', error);
        if (playCounterEl) {
          playCounterEl.textContent = 'Oynanma sayÄ±sÄ± yÃ¼klenemedi.';
          if (isInitialLoad) {
            positionCounter(true); 
          }
        }
      }
    }

    async function incrementAndShowPlayCount() {
      try {
        const response = await fetch('/api/incrementPlayCount', { method: 'POST' });
        if (!response.ok) {
          throw new Error(`SayaÃ§ arttÄ±rÄ±lamadÄ±: ${response.statusText}`);
        }
        const data = await response.json();
        if (playCounterEl) {
          playCounterEl.textContent = `Bu oyun ${data.count} kez oynandÄ±.`;
        }
        return data.count; 
      } catch (error) {
        console.error('SayaÃ§ artÄ±rma hatasÄ±:', error);
        return null;
      }
    }

    // --- Ana Oyun Fonksiyonu (Animasyon Sesi Entegre EdilmiÅŸ) ---
    async function playGame() { 
      // Animasyon sesini baÅŸlat
      if (gameAnimationSound && typeof gameAnimationSound.play === 'function') {
        gameAnimationSound.currentTime = 0; // Her seferinde baÅŸa sar
        gameAnimationSound.play().catch(e => console.warn("Animasyon sesi Ã§alÄ±namadÄ±:", e));
      }

      incrementAndShowPlayCount().then(newCount => {
        if (newCount !== null) {
          console.log("SayaÃ§ baÅŸarÄ±yla arttÄ±rÄ±ldÄ±, yeni deÄŸer:", newCount);
        }
      });
      
      positionCounter(true); 

      shareBtn.classList.remove('visible'); 
      resultEl.classList.remove('revealed'); 
      resultEl.style.opacity = '0'; 
      resultEl.style.boxShadow = 'none'; 
       
      resultEl.textContent = "?";
      resultEl.classList.add('flickering'); 
       
      if(playButtonEl) {
          playButtonEl.disabled = true;
          playButtonEl.style.display = 'none'; 
      }

      if (intervalId) {
          clearInterval(intervalId);
      }

      displayOrderCharacters = [...characters].sort(() => 0.5 - Math.random());
      currentDisplayIndex = 0;

      // Karakter deÄŸiÅŸtirme animasyonu (ses Ã‡IKARILDI)
      intervalId = setInterval(() => {
          if (displayOrderCharacters.length > 0) {
              resultEl.textContent = displayOrderCharacters[currentDisplayIndex];
              currentDisplayIndex = (currentDisplayIndex + 1) % displayOrderCharacters.length; 
          }
      }, 75); 

      setTimeout(() => {
          clearInterval(intervalId);
          // Animasyon sesini durdur
          if (gameAnimationSound && typeof gameAnimationSound.pause === 'function') {
            gameAnimationSound.pause();
          }

          resultEl.classList.remove('flickering');

          const finalCharacter = characters[Math.floor(Math.random() * characters.length)]; 
          resultEl.textContent = finalCharacter;
          resultEl.classList.add('revealed'); 
           
          // Ä°sterseniz burada ayrÄ± bir "sonuÃ§ gÃ¶sterme" sesi Ã§alabilirsiniz.
          // Ã–rnek: revealSound.play().catch(e => console.warn("SonuÃ§ sesi Ã§alÄ±namadÄ±:", e));

          shareBtn.classList.add('visible'); 
          shareBtn.dataset.character = finalCharacter;
          if(playButtonEl) {
              playButtonEl.textContent = "TEKRAR OYNA? ðŸ”„"; 
              playButtonEl.disabled = false;
              playButtonEl.style.display = 'block'; 
          }
          positionCounter(false); 
      }, gameAnimationDuration); // Sabit sÃ¼re yerine gameAnimationDuration deÄŸiÅŸkenini kullandÄ±k
    }

    // --- PaylaÅŸÄ±m FonksiyonlarÄ± ---
    function shareResult() {
      const character = shareBtn.dataset.character;
      openTwitterIntent(character); 
    }

    function openTwitterIntent(character) {
        if (!character) character = "bilinmeyen_karakter"; 
        const text = encodeURIComponent(`Paralel evrende ben bir "${character}" oldum! Sen kimsin? ðŸ¤¯ #ParalelHukukEvreni`);
        const url = encodeURIComponent(window.location.href);
        const twitterUrl = `https://twitter.com/intent/tweet?text=${text}&url=${url}`;
        window.open(twitterUrl, '_blank');
    }
  </script>
</body>
</html>
